import{j as G}from"./jsx-runtime-DiklIkkE.js";import"./SfxProvider-C05We5iG.js";import{u as se}from"./useSfx-BACfETso.js";import{c as re}from"./clsx-B-dksMZM.js";import{r as N}from"./index-DRjF_FHU.js";import{D as ie}from"./Sign-DADmf3_9.js";import{T as q}from"./Token-DuPhmN9g.js";import{c as oe,b as ue,d as le,r as ce,i as fe,e as me,f as ge,g as $,h as de,j as pe,k as he,s as ye,p as ve,V as Se,l as xe,n as Ee,S as be,H as De,v as k,o as Ae,q as Ve,t as Te,G as je,u as J,m as Q}from"./proxy-BjE8Ig1W.js";function Me(e){return N.useEffect(()=>()=>e(),[])}function Ie(e,t=100,n){const a=n({...e,keyframes:[0,t]}),s=Math.min(oe(a),ue);return{type:"keyframes",ease:i=>a.next(s*i).value/t,duration:le(s)}}function _(e){return typeof e=="object"&&!Array.isArray(e)}function ee(e,t,n,a){return typeof e=="string"&&_(t)?ce(e,n,a):e instanceof NodeList?Array.from(e):Array.isArray(e)?e:[e]}function X(e,t,n,a){var s;return typeof t=="number"?t:t.startsWith("-")||t.startsWith("+")?Math.max(0,e+parseFloat(t)):t==="<"?n:(s=a.get(t))!==null&&s!==void 0?s:e}const Oe=(e,t,n)=>{const a=t-e;return((n-e)%a+a)%a+e};function te(e,t){return fe(e)?e[Oe(0,e.length,t)]:e}function we(e,t,n){for(let a=0;a<e.length;a++){const s=e[a];s.at>t&&s.at<n&&(ge(e,s),a--)}}function Ge(e,t,n,a,s,i){we(e,s,i);for(let r=0;r<t.length;r++)e.push({value:t[r],at:me(s,i,a[r]),easing:te(n,r)})}function Ne(e,t){return e.at===t.at?e.value===null?1:t.value===null?-1:0:e.at-t.at}function Ce(e,t){for(let n=0;n<e.length;n++)e[n]=e[n]/(t+1)}function Ke(e,t,n){return e*(t+1)}const Pe="easeInOut";function ke(e,{defaultTransition:t={},...n}={},a,s){const i=t.duration||.3,r=new Map,l=new Map,v={},S=new Map;let D=0,o=0,T=0;for(let x=0;x<e.length;x++){const f=e[x];if(typeof f=="string"){S.set(f,o);continue}else if(!Array.isArray(f)){S.set(f.name,X(o,f.at,D,S));continue}let[h,m,c={}]=f;c.at!==void 0&&(o=X(o,c.at,D,S));let g=0;const E=(d,p,A,j=0,M=0)=>{const u=ze(d),{delay:z=0,times:b=de(u),type:F="keyframes",repeat:C,repeatType:Ze,repeatDelay:$e=0,...ae}=p;let{ease:V=t.ease||"easeOut",duration:y}=p;const L=typeof z=="function"?z(j,M):z,B=u.length,R=he(F)?F:s==null?void 0:s[F];if(B<=2&&R){let I=100;if(B===2&&Le(u)){const O=u[1]-u[0];I=Math.abs(O)}const K={...ae};y!==void 0&&(K.duration=ye(y));const P=Ie(K,I,R);V=P.ease,y=P.duration}y??(y=i);const H=o+L;b.length===1&&b[0]===0&&(b[1]=1);const W=b.length-u.length;if(W>0&&pe(b,W),u.length===1&&u.unshift(null),C){y=Ke(y,C);const I=[...u],K=[...b];V=Array.isArray(V)?[...V]:[V];const P=[...V];for(let O=0;O<C;O++){u.push(...I);for(let w=0;w<I.length;w++)b.push(K[w]+(O+1)),V.push(w===0?"linear":te(P,w-1))}Ce(b,C)}const U=H+y;Ge(A,u,V,b,H,U),g=Math.max(L+y,g),T=Math.max(U,T)};if($(h)){const d=Y(h,l);E(m,c,Z("default",d))}else{const d=ee(h,m,a,v),p=d.length;for(let A=0;A<p;A++){m=m,c=c;const j=d[A],M=Y(j,l);for(const u in m)E(m[u],Fe(c,u),Z(u,M),A,p)}}D=o,o+=g}return l.forEach((x,f)=>{for(const h in x){const m=x[h];m.sort(Ne);const c=[],g=[],E=[];for(let p=0;p<m.length;p++){const{at:A,value:j,easing:M}=m[p];c.push(j),g.push(ve(0,T,A)),E.push(M||"easeOut")}g[0]!==0&&(g.unshift(0),c.unshift(c[0]),E.unshift(Pe)),g[g.length-1]!==1&&(g.push(1),c.push(null)),r.has(f)||r.set(f,{keyframes:{},transition:{}});const d=r.get(f);d.keyframes[h]=c,d.transition[h]={...t,duration:T,ease:E,times:g,...n}}}),r}function Y(e,t){return!t.has(e)&&t.set(e,{}),t.get(e)}function Z(e,t){return t[e]||(t[e]=[]),t[e]}function ze(e){return Array.isArray(e)?e:[e]}function Fe(e,t){return e&&e[t]?{...e,...e[t]}:{...e}}const _e=e=>typeof e=="number",Le=e=>e.every(_e);function Be(e,t){return e in t}class Re extends Se{constructor(){super(...arguments),this.type="object"}readValueFromInstance(t,n){if(Be(n,t)){const a=t[n];if(typeof a=="string"||typeof a=="number")return a}}getBaseTargetFromProps(){}removeValueFromRenderState(t,n){delete n.output[t]}measureInstanceViewportBox(){return xe()}build(t,n){Object.assign(t.output,n)}renderInstance(t,{output:n}){Object.assign(t,n)}sortInstanceNodePosition(){return 0}}function He(e){const t={presenceContext:null,props:{},visualState:{renderState:{transform:{},transformOrigin:{},style:{},vars:{},attrs:{}},latestValues:{}}},n=Ee(e)?new be(t):new De(t);n.mount(e),k.set(e,n)}function We(e){const t={presenceContext:null,props:{},visualState:{renderState:{output:{}},latestValues:{}}},n=new Re(t);n.mount(e),k.set(e,n)}function Ue(e,t){return $(e)||typeof e=="number"||typeof e=="string"&&!_(t)}function ne(e,t,n,a){const s=[];if(Ue(e,t))s.push(Ae(e,_(t)&&t.default||t,n&&(n.default||n)));else{const i=ee(e,t,a),r=i.length;for(let l=0;l<r;l++){const v=i[l],S=v instanceof Element?He:We;k.has(v)||S(v);const D=k.get(v),o={...n};"delay"in o&&typeof o.delay=="function"&&(o.delay=o.delay(l,r)),s.push(...Ve(D,{...t,transition:o},{}))}}return s}function qe(e,t,n){const a=[];return ke(e,t,n,{spring:Te}).forEach(({keyframes:i,transition:r},l)=>{a.push(...ne(l,i,r))}),a}function Je(e){return Array.isArray(e)&&Array.isArray(e[0])}function Qe(e){function t(n,a,s){let i=[];Je(n)?i=qe(n,a,e):i=ne(n,a,s,e);const r=new je(i);return e&&e.animations.push(r),r}return t}function Xe(){const e=J(()=>({current:null,animations:[]})),t=J(()=>Qe(e));return Me(()=>{e.animations.forEach(n=>n.stop())}),[e,t]}const Ye=e=>{const{id:t,variant:n,size:a,highlighted:s,value:i,reusable:r=!0,onDragStart:l,onDragEnd:v,...S}={...e,...N.useContext(ie)},[D,o]=Xe(),{play:T}=se(),[x,f]=N.useState(e.inactive||!1),[h,m]=N.useState(!1);N.useEffect(()=>f(S.inactive),[S.inactive]);const c=(...d)=>{m(!0),T({src:"/sfx/gaming_bloc2.mp3",volume:.5}),l==null||l(...d)},g=async(...d)=>{m(!1);const p=v==null?void 0:v(...d);p&&f(!0),o(D.current,{x:0,y:0,scale:1},p?{duration:0}:{type:"spring",duration:.3,onPlay:()=>void T({src:"/sfx/gaming_bloc2.mp3",volume:.1})})},E={id:t,size:a,variant:n,value:i,highlighted:s};return G.jsxs("div",{className:re("relative flex cursor-grab",h?"z-10":"z-[1]"),children:[G.jsx(Q.div,{id:t,ref:D,drag:!0,dragSnapToOrigin:!0,whileDrag:{zIndex:999,scale:1.2},dragElastic:.2,dragTransition:{bounceStiffness:1e3},onDragStart:c,onDragEnd:g,...S,children:G.jsx(q,{...E,inactive:h||r?!1:x})}),h&&G.jsx(Q.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},className:"absolute",children:G.jsx(q,{...E,inactive:!r||x})})]})};Ye.__docgenInfo={description:"",methods:[],displayName:"DraggableToken"};export{Ye as D,Xe as u};
