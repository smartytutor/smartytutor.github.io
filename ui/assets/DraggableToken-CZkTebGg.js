import{j as G}from"./jsx-runtime-CkxqCPlQ.js";import{c as se}from"./clsx-B-dksMZM.js";import{r as k}from"./index-DJO9vBfz.js";import{D as re}from"./Sign-D0SSdnMi.js";import{T as q}from"./Token-SMuRVrz4.js";import{c as ie,b as oe,d as ue,r as le,i as ce,e as fe,f as me,g as $,h as ge,j as de,k as pe,p as he,s as ye,V as ve,l as Se,n as Ee,S as xe,H as De,v as z,o as be,q as Ae,t as Ve,G as Te,u as J,m as Q}from"./proxy-Bu-Muats.js";function je(e){return k.useEffect(()=>()=>e(),[])}function Me(e,t=100,n){const a=n({...e,keyframes:[0,t]}),s=Math.min(ie(a),oe);return{type:"keyframes",ease:i=>a.next(s*i).value/t,duration:ue(s)}}function L(e){return typeof e=="object"&&!Array.isArray(e)}function ee(e,t,n,a){return typeof e=="string"&&L(t)?le(e,n,a):e instanceof NodeList?Array.from(e):Array.isArray(e)?e:[e]}function X(e,t,n,a){var s;return typeof t=="number"?t:t.startsWith("-")||t.startsWith("+")?Math.max(0,e+parseFloat(t)):t==="<"?n:(s=a.get(t))!==null&&s!==void 0?s:e}const Ie=(e,t,n)=>{const a=t-e;return((n-e)%a+a)%a+e};function te(e,t){return ce(e)?e[Ie(0,e.length,t)]:e}function Oe(e,t,n){for(let a=0;a<e.length;a++){const s=e[a];s.at>t&&s.at<n&&(me(e,s),a--)}}function we(e,t,n,a,s,i){Oe(e,s,i);for(let r=0;r<t.length;r++)e.push({value:t[r],at:fe(s,i,a[r]),easing:te(n,r)})}function Ge(e,t){return e.at===t.at?e.value===null?1:t.value===null?-1:0:e.at-t.at}function Ne(e,t){for(let n=0;n<e.length;n++)e[n]=e[n]/(t+1)}function Ce(e,t,n){return e*(t+1)}const Ke="easeInOut";function ke(e,{defaultTransition:t={},...n}={},a,s){const i=t.duration||.3,r=new Map,l=new Map,h={},x=new Map;let D=0,o=0,T=0;for(let b=0;b<e.length;b++){const c=e[b];if(typeof c=="string"){x.set(c,o);continue}else if(!Array.isArray(c)){x.set(c.name,X(o,c.at,D,x));continue}let[y,g,f={}]=c;f.at!==void 0&&(o=X(o,f.at,D,x));let m=0;const v=(d,S,A,j=0,M=0)=>{const u=ze(d),{delay:F=0,times:E=ge(u),type:P="keyframes",repeat:N,repeatType:Ye,repeatDelay:Ze=0,...ae}=S;let{ease:V=t.ease||"easeOut",duration:p}=S;const B=typeof F=="function"?F(j,M):F,_=u.length,R=de(P)?P:s==null?void 0:s[P];if(_<=2&&R){let I=100;if(_===2&&Le(u)){const O=u[1]-u[0];I=Math.abs(O)}const C={...ae};p!==void 0&&(C.duration=ye(p));const K=Me(C,I,R);V=K.ease,p=K.duration}p??(p=i);const H=o+B;E.length===1&&E[0]===0&&(E[1]=1);const W=E.length-u.length;if(W>0&&pe(E,W),u.length===1&&u.unshift(null),N){p=Ce(p,N);const I=[...u],C=[...E];V=Array.isArray(V)?[...V]:[V];const K=[...V];for(let O=0;O<N;O++){u.push(...I);for(let w=0;w<I.length;w++)E.push(C[w]+(O+1)),V.push(w===0?"linear":te(K,w-1))}Ne(E,N)}const U=H+p;we(A,u,V,E,H,U),m=Math.max(B+p,m),T=Math.max(U,T)};if($(y)){const d=Y(y,l);v(g,f,Z("default",d))}else{const d=ee(y,g,a,h),S=d.length;for(let A=0;A<S;A++){g=g,f=f;const j=d[A],M=Y(j,l);for(const u in g)v(g[u],Fe(f,u),Z(u,M),A,S)}}D=o,o+=m}return l.forEach((b,c)=>{for(const y in b){const g=b[y];g.sort(Ge);const f=[],m=[],v=[];for(let S=0;S<g.length;S++){const{at:A,value:j,easing:M}=g[S];f.push(j),m.push(he(0,T,A)),v.push(M||"easeOut")}m[0]!==0&&(m.unshift(0),f.unshift(f[0]),v.unshift(Ke)),m[m.length-1]!==1&&(m.push(1),f.push(null)),r.has(c)||r.set(c,{keyframes:{},transition:{}});const d=r.get(c);d.keyframes[y]=f,d.transition[y]={...t,duration:T,ease:v,times:m,...n}}}),r}function Y(e,t){return!t.has(e)&&t.set(e,{}),t.get(e)}function Z(e,t){return t[e]||(t[e]=[]),t[e]}function ze(e){return Array.isArray(e)?e:[e]}function Fe(e,t){return e&&e[t]?{...e,...e[t]}:{...e}}const Pe=e=>typeof e=="number",Le=e=>e.every(Pe);function Be(e,t){return e in t}class _e extends ve{constructor(){super(...arguments),this.type="object"}readValueFromInstance(t,n){if(Be(n,t)){const a=t[n];if(typeof a=="string"||typeof a=="number")return a}}getBaseTargetFromProps(){}removeValueFromRenderState(t,n){delete n.output[t]}measureInstanceViewportBox(){return Se()}build(t,n){Object.assign(t.output,n)}renderInstance(t,{output:n}){Object.assign(t,n)}sortInstanceNodePosition(){return 0}}function Re(e){const t={presenceContext:null,props:{},visualState:{renderState:{transform:{},transformOrigin:{},style:{},vars:{},attrs:{}},latestValues:{}}},n=Ee(e)?new xe(t):new De(t);n.mount(e),z.set(e,n)}function He(e){const t={presenceContext:null,props:{},visualState:{renderState:{output:{}},latestValues:{}}},n=new _e(t);n.mount(e),z.set(e,n)}function We(e,t){return $(e)||typeof e=="number"||typeof e=="string"&&!L(t)}function ne(e,t,n,a){const s=[];if(We(e,t))s.push(be(e,L(t)&&t.default||t,n&&(n.default||n)));else{const i=ee(e,t,a),r=i.length;for(let l=0;l<r;l++){const h=i[l],x=h instanceof Element?Re:He;z.has(h)||x(h);const D=z.get(h),o={...n};"delay"in o&&typeof o.delay=="function"&&(o.delay=o.delay(l,r)),s.push(...Ae(D,{...t,transition:o},{}))}}return s}function Ue(e,t,n){const a=[];return ke(e,t,n,{spring:Ve}).forEach(({keyframes:i,transition:r},l)=>{a.push(...ne(l,i,r))}),a}function qe(e){return Array.isArray(e)&&Array.isArray(e[0])}function Je(e){function t(n,a,s){let i=[];qe(n)?i=Ue(n,a,e):i=ne(n,a,s,e);const r=new Te(i);return e&&e.animations.push(r),r}return t}function Qe(){const e=J(()=>({current:null,animations:[]})),t=J(()=>Je(e));return je(()=>{e.animations.forEach(n=>n.stop())}),[e,t]}const Xe=e=>{const{id:t,variant:n,size:a,highlighted:s,value:i,reusable:r=!0,onDragStart:l,onDragEnd:h,...x}={...e,...k.useContext(re)},[D,o]=Qe(),[T,b]=k.useState(e.inactive||!1),[c,y]=k.useState(!1),g=(...v)=>{y(!0),l==null||l(...v)},f=async(...v)=>{y(!1);const d=h==null?void 0:h(...v);d&&b(!0),o(D.current,{x:0,y:0,scale:1},d?{duration:0}:{type:"spring",duration:.3})},m={id:t,size:a,variant:n,value:i,highlighted:s};return G.jsxs("div",{className:se("relative flex cursor-grab",c?"z-10":"z-[1]"),children:[G.jsx(Q.div,{id:t,ref:D,drag:!0,dragSnapToOrigin:!0,whileDrag:{zIndex:999,scale:1.2},dragElastic:.2,dragTransition:{bounceStiffness:1e3},onDragStart:g,onDragEnd:f,...x,children:G.jsx(q,{...m,inactive:c||r?!1:T})}),c&&G.jsx(Q.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},className:"absolute",children:G.jsx(q,{...m,inactive:!r||T})})]})};Xe.__docgenInfo={description:"",methods:[],displayName:"DraggableToken"};export{Xe as D};
