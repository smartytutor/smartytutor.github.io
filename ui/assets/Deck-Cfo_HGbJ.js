import{j as c}from"./jsx-runtime-DR9Q75dM.js";import{c as k}from"./clsx-B-dksMZM.js";import{A as I}from"./AnimatedCard-CrZRt16x.js";import{r as o}from"./index-DRjF_FHU.js";import{M as S,u as A,P as _,a as z,L as D,m as R}from"./proxy-C00yw4cG.js";class $ extends o.Component{getSnapshotBeforeUpdate(i){const e=this.props.childRef.current;if(e&&i.isPresent&&!this.props.isPresent){const s=this.props.sizeRef.current;s.height=e.offsetHeight||0,s.width=e.offsetWidth||0,s.top=e.offsetTop,s.left=e.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function T({children:t,isPresent:i}){const e=o.useId(),s=o.useRef(null),f=o.useRef({width:0,height:0,top:0,left:0}),{nonce:C}=o.useContext(S);return o.useInsertionEffect(()=>{const{width:m,height:n,top:p,left:u}=f.current;if(i||!s.current||!m||!n)return;s.current.dataset.motionPopId=e;const d=document.createElement("style");return C&&(d.nonce=C),document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${e}"] {
            position: absolute !important;
            width: ${m}px !important;
            height: ${n}px !important;
            top: ${p}px !important;
            left: ${u}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[i]),c.jsx($,{isPresent:i,childRef:s,sizeRef:f,children:o.cloneElement(t,{ref:s})})}const V=({children:t,initial:i,isPresent:e,onExitComplete:s,custom:f,presenceAffectsLayout:C,mode:m})=>{const n=A(N),p=o.useId(),u=o.useCallback(a=>{n.set(a,!0);for(const y of n.values())if(!y)return;s&&s()},[n,s]),d=o.useMemo(()=>({id:p,initial:i,isPresent:e,custom:f,onExitComplete:u,register:a=>(n.set(a,!1),()=>n.delete(a))}),C?[Math.random(),u]:[e,u]);return o.useMemo(()=>{n.forEach((a,y)=>n.set(y,!1))},[e]),o.useEffect(()=>{!e&&!n.size&&s&&s()},[e]),m==="popLayout"&&(t=c.jsx(T,{isPresent:e,children:t})),c.jsx(_.Provider,{value:d,children:t})};function N(){return new Map}const v=t=>t.key||"";function j(t){const i=[];return o.Children.forEach(t,e=>{o.isValidElement(e)&&i.push(e)}),i}const q=({children:t,exitBeforeEnter:i,custom:e,initial:s=!0,onExitComplete:f,presenceAffectsLayout:C=!0,mode:m="sync"})=>{const n=o.useMemo(()=>j(t),[t]),p=n.map(v),u=o.useRef(!0),d=o.useRef(n),a=A(()=>new Map),[y,L]=o.useState(n),[h,P]=o.useState(n);z(()=>{u.current=!1,d.current=n;for(let l=0;l<h.length;l++){const r=v(h[l]);p.includes(r)?a.delete(r):a.get(r)!==!0&&a.set(r,!1)}},[h,p.length,p.join("-")]);const g=[];if(n!==y){let l=[...n];for(let r=0;r<h.length;r++){const x=h[r],M=v(x);p.includes(M)||(l.splice(r,0,x),g.push(x))}m==="wait"&&g.length&&(l=g),P(j(l)),L(n);return}const{forceRender:w}=o.useContext(D);return c.jsx(c.Fragment,{children:h.map(l=>{const r=v(l),x=n===h||p.includes(r),M=()=>{if(a.has(r))a.set(r,!0);else return;let E=!0;a.forEach(b=>{b||(E=!1)}),E&&(w==null||w(),P(d.current),f&&f())};return c.jsx(V,{isPresent:x,initial:!u.current||s?void 0:!1,custom:x?void 0:e,presenceAffectsLayout:C,mode:m,onExitComplete:x?void 0:M,children:l},r)})})},B={decked:t=>({marginTop:-t,marginLeft:t,boxShadow:"-1px 1px 1px 0px #00000059"}),served:{boxShadow:"0px 4px 16px 0px #00000080"},selected:{scale:1.17,boxShadow:"0px 2px 6px 0px #0000004D"},discarded:t=>({rotate:Math.random()*t*(Math.round(Math.random())*2-1),boxShadow:"0px 0px 1px 0px #00000059"})},K={initial:{opacity:0,translateX:"5%",translateY:"-5%"},ready:{opacity:1,translateX:0,translateY:0,transition:{duration:.3}}},U=({variant:t="default",cards:i})=>c.jsx(q,{children:c.jsx(R.div,{className:k("relative rounded-[9px]",t==="default"&&"shadow-[0px_4px_16px_0px_#00000080]"),variants:K,initial:"initial",animate:"ready",children:i.map((e,s)=>c.jsx(R.div,{className:k(s>0&&"absolute left-0 top-0"),initial:t==="default"?"decked":"discarded",children:c.jsx(I,{...e,variants:B,layoutId:e.id,custom:s})},e.id))})});U.__docgenInfo={description:"",methods:[],displayName:"Deck",props:{variant:{required:!1,tsType:{name:"union",raw:"'default' | 'discard'",elements:[{name:"literal",value:"'default'"},{name:"literal",value:"'discard'"}]},description:"",defaultValue:{value:"'default'",computed:!1}},cards:{required:!0,tsType:{name:"Array",elements:[{name:"intersection",raw:"Card & AnimationProps & AnimationLifecycles & Pick<MotionAdvancedProps, 'custom'>",elements:[{name:"Card"},{name:"AnimationProps"},{name:"AnimationLifecycles"},{name:"Pick",elements:[{name:"MotionAdvancedProps"},{name:"literal",value:"'custom'"}],raw:"Pick<MotionAdvancedProps, 'custom'>"}]}],raw:"MemoCard[]"},description:""}}};export{q as A,U as D,B as m};
