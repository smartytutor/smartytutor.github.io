import{j as G}from"./jsx-runtime-CkxqCPlQ.js";import{r as K}from"./index-DJO9vBfz.js";import{c as se}from"./clsx-B-dksMZM.js";import{D as re}from"./Sign-M3dRSRBQ.js";import{T as U}from"./Token-BlVuBQLc.js";import{c as ie,b as oe,d as ue,r as le,i as ce,e as fe,f as me,g as $,h as de,j as pe,k as ge,p as he,s as ye,V as ve,l as Se,n as Ee,S as be,H as xe,v as k,o as De,q as Ae,t as Te,G as Ve,u as J,m as Q}from"./proxy-Bu-Muats.js";function je(e){return K.useEffect(()=>()=>e(),[])}function Me(e,t=100,n){const a=n({...e,keyframes:[0,t]}),s=Math.min(ie(a),oe);return{type:"keyframes",ease:i=>a.next(s*i).value/t,duration:ue(s)}}function q(e){return typeof e=="object"&&!Array.isArray(e)}function ee(e,t,n,a){return typeof e=="string"&&q(t)?le(e,n,a):e instanceof NodeList?Array.from(e):Array.isArray(e)?e:[e]}function X(e,t,n,a){var s;return typeof t=="number"?t:t.startsWith("-")||t.startsWith("+")?Math.max(0,e+parseFloat(t)):t==="<"?n:(s=a.get(t))!==null&&s!==void 0?s:e}const Ie=(e,t,n)=>{const a=t-e;return((n-e)%a+a)%a+e};function te(e,t){return ce(e)?e[Ie(0,e.length,t)]:e}function Oe(e,t,n){for(let a=0;a<e.length;a++){const s=e[a];s.at>t&&s.at<n&&(me(e,s),a--)}}function we(e,t,n,a,s,i){Oe(e,s,i);for(let r=0;r<t.length;r++)e.push({value:t[r],at:fe(s,i,a[r]),easing:te(n,r)})}function Ge(e,t){return e.at===t.at?e.value===null?1:t.value===null?-1:0:e.at-t.at}function Ne(e,t){for(let n=0;n<e.length;n++)e[n]=e[n]/(t+1)}function ze(e,t,n){return e*(t+1)}const Ce="easeInOut";function Ke(e,{defaultTransition:t={},...n}={},a,s){const i=t.duration||.3,r=new Map,l=new Map,h={},b=new Map;let x=0,o=0,V=0;for(let D=0;D<e.length;D++){const c=e[D];if(typeof c=="string"){b.set(c,o);continue}else if(!Array.isArray(c)){b.set(c.name,X(o,c.at,x,b));continue}let[y,d,f={}]=c;f.at!==void 0&&(o=X(o,f.at,x,b));let m=0;const v=(p,S,A,j=0,M=0)=>{const u=ke(p),{delay:F=0,times:E=de(u),type:P="keyframes",repeat:N,repeatType:Ye,repeatDelay:Ze=0,...ae}=S;let{ease:T=t.ease||"easeOut",duration:g}=S;const L=typeof F=="function"?F(j,M):F,B=u.length,_=pe(P)?P:s==null?void 0:s[P];if(B<=2&&_){let I=100;if(B===2&&qe(u)){const O=u[1]-u[0];I=Math.abs(O)}const z={...ae};g!==void 0&&(z.duration=ye(g));const C=Me(z,I,_);T=C.ease,g=C.duration}g??(g=i);const R=o+L;E.length===1&&E[0]===0&&(E[1]=1);const H=E.length-u.length;if(H>0&&ge(E,H),u.length===1&&u.unshift(null),N){g=ze(g,N);const I=[...u],z=[...E];T=Array.isArray(T)?[...T]:[T];const C=[...T];for(let O=0;O<N;O++){u.push(...I);for(let w=0;w<I.length;w++)E.push(z[w]+(O+1)),T.push(w===0?"linear":te(C,w-1))}Ne(E,N)}const W=R+g;we(A,u,T,E,R,W),m=Math.max(L+g,m),V=Math.max(W,V)};if($(y)){const p=Y(y,l);v(d,f,Z("default",p))}else{const p=ee(y,d,a,h),S=p.length;for(let A=0;A<S;A++){d=d,f=f;const j=p[A],M=Y(j,l);for(const u in d)v(d[u],Fe(f,u),Z(u,M),A,S)}}x=o,o+=m}return l.forEach((D,c)=>{for(const y in D){const d=D[y];d.sort(Ge);const f=[],m=[],v=[];for(let S=0;S<d.length;S++){const{at:A,value:j,easing:M}=d[S];f.push(j),m.push(he(0,V,A)),v.push(M||"easeOut")}m[0]!==0&&(m.unshift(0),f.unshift(f[0]),v.unshift(Ce)),m[m.length-1]!==1&&(m.push(1),f.push(null)),r.has(c)||r.set(c,{keyframes:{},transition:{}});const p=r.get(c);p.keyframes[y]=f,p.transition[y]={...t,duration:V,ease:v,times:m,...n}}}),r}function Y(e,t){return!t.has(e)&&t.set(e,{}),t.get(e)}function Z(e,t){return t[e]||(t[e]=[]),t[e]}function ke(e){return Array.isArray(e)?e:[e]}function Fe(e,t){return e&&e[t]?{...e,...e[t]}:{...e}}const Pe=e=>typeof e=="number",qe=e=>e.every(Pe);function Le(e,t){return e in t}class Be extends ve{constructor(){super(...arguments),this.type="object"}readValueFromInstance(t,n){if(Le(n,t)){const a=t[n];if(typeof a=="string"||typeof a=="number")return a}}getBaseTargetFromProps(){}removeValueFromRenderState(t,n){delete n.output[t]}measureInstanceViewportBox(){return Se()}build(t,n){Object.assign(t.output,n)}renderInstance(t,{output:n}){Object.assign(t,n)}sortInstanceNodePosition(){return 0}}function _e(e){const t={presenceContext:null,props:{},visualState:{renderState:{transform:{},transformOrigin:{},style:{},vars:{},attrs:{}},latestValues:{}}},n=Ee(e)?new be(t):new xe(t);n.mount(e),k.set(e,n)}function Re(e){const t={presenceContext:null,props:{},visualState:{renderState:{output:{}},latestValues:{}}},n=new Be(t);n.mount(e),k.set(e,n)}function He(e,t){return $(e)||typeof e=="number"||typeof e=="string"&&!q(t)}function ne(e,t,n,a){const s=[];if(He(e,t))s.push(De(e,q(t)&&t.default||t,n&&(n.default||n)));else{const i=ee(e,t,a),r=i.length;for(let l=0;l<r;l++){const h=i[l],b=h instanceof Element?_e:Re;k.has(h)||b(h);const x=k.get(h),o={...n};"delay"in o&&typeof o.delay=="function"&&(o.delay=o.delay(l,r)),s.push(...Ae(x,{...t,transition:o},{}))}}return s}function We(e,t,n){const a=[];return Ke(e,t,n,{spring:Te}).forEach(({keyframes:i,transition:r},l)=>{a.push(...ne(l,i,r))}),a}function Ue(e){return Array.isArray(e)&&Array.isArray(e[0])}function Je(e){function t(n,a,s){let i=[];Ue(n)?i=We(n,a,e):i=ne(n,a,s,e);const r=new Ve(i);return e&&e.animations.push(r),r}return t}function Qe(){const e=J(()=>({current:null,animations:[]})),t=J(()=>Je(e));return je(()=>{e.animations.forEach(n=>n.stop())}),[e,t]}const Xe=e=>{const{id:t,variant:n,size:a,highlighted:s,value:i,reusable:r=!0,onDragStart:l,onDragEnd:h,...b}={...e,...K.useContext(re)},[x,o]=Qe(),[V,D]=K.useState(e.inactive||!1),[c,y]=K.useState(!1),d=(...v)=>{y(!0),l==null||l(...v)},f=async(...v)=>{y(!1);const p=h==null?void 0:h(...v);p&&D(!0),o(x.current,{x:0,y:0,scale:1},p?{duration:0}:{type:"spring",duration:.3})},m={id:t,size:a,variant:n,value:i,highlighted:s};return G.jsxs("div",{className:se("relative flex cursor-grab",c?"z-10":"z-[1]"),children:[G.jsx(Q.div,{id:t,ref:x,drag:!0,dragSnapToOrigin:!0,whileDrag:{zIndex:999,scale:1.2},dragElastic:.2,dragTransition:{bounceStiffness:1e3},onDragStart:d,onDragEnd:f,...b,children:G.jsx(U,{...m,inactive:c||r?!1:V})}),c&&G.jsx(Q.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},className:"absolute",children:G.jsx(U,{...m,inactive:!r||V})})]})};Xe.__docgenInfo={description:"",methods:[],displayName:"DraggableToken",props:{id:{required:!0,tsType:{name:"string"},description:""},size:{required:!1,tsType:{name:"union",raw:"'default' | 'small'",elements:[{name:"literal",value:"'default'"},{name:"literal",value:"'small'"}]},description:""},highlighted:{required:!1,tsType:{name:"boolean"},description:""},inactive:{required:!1,tsType:{name:"boolean"},description:""},reusable:{required:!1,tsType:{name:"boolean"},description:""}}};export{Xe as D};
